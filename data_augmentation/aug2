import os
import cv2
from PIL import Image
import numpy as np

# ì´ë¯¸ì§€ê°€ ë“¤ì–´ ìˆëŠ” ìµœìƒìœ„ í´ë” ê²½ë¡œ (Google Drive ë‚´ ê²½ë¡œ)
base_path = '/content/drive/MyDrive/Unknown2'

# ì´ë¯¸ì§€ í™•ì¥ì ë¦¬ìŠ¤íŠ¸
valid_exts = ['.jpg', '.jpeg', '.png', '.bmp']

# ì¦ê°•ëœ ì´ë¯¸ì§€ ì €ì¥ ê°œìˆ˜ ì¹´ìš´í„°
augment_cnt = 1
image_cnt = 0

# í•˜ìœ„ í´ë”ê¹Œì§€ ëª¨ë‘ ìˆœíšŒ
for root, dirs, files in os.walk(base_path):
    for file in files:
        if os.path.splitext(file)[-1].lower() in valid_exts:
            image_cnt += 1
            image_path = os.path.join(root, file)
            print(f"ğŸ“· ì²˜ë¦¬ ì¤‘: {image_path}")

            image = Image.open(image_path)

            # 1. ì¢Œìš° ë°˜ì „
            inverted = image.transpose(Image.FLIP_LEFT_RIGHT)
            inverted.save(os.path.join(root, f'inverted_{augment_cnt}.png'))
            augment_cnt += 1

            # 2. íšŒì „ (-20ë„ ~ 20ë„)
            rotated = image.rotate(np.random.randint(-20, 21))
            rotated.save(os.path.join(root, f'rotated_{augment_cnt}.png'))
            augment_cnt += 1

            # 3. ë¸”ëŸ¬ ì²˜ë¦¬
            img_cv = cv2.imread(image_path)
            if img_cv is not None:
                blurred = cv2.GaussianBlur(img_cv, (21, 21), 0)
                blurred_rgb = cv2.cvtColor(blurred, cv2.COLOR_BGR2RGB)
                blurred_image = Image.fromarray(blurred_rgb)
                blurred_image.save(os.path.join(root, f'blurred_{augment_cnt}.png'))
                augment_cnt += 1
            else:
                print(f"âš ï¸ ì´ë¯¸ì§€ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨: {image_path}")

print(f"\nğŸ” ì´ ì´ë¯¸ì§€ íŒŒì¼ ìˆ˜: {image_cnt}")
print(f"âœ… ì´ {augment_cnt - 1}ê°œì˜ ì¦ê°• ì´ë¯¸ì§€ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.")
